# QA-Test

Project to complete the technical test for QA interview process in CHS. 

1. Fork the project. 
2. Implement all the defined features.
3. Upload your results and share it with the interviewer 

# Requirements
* [Nodejs](https://nodejs.org/en/)
* [Allure](http://allure.qatools.ru/) (for the reporting)
* [TypeScript](https://www.typescriptlang.org/)

## Recommended IDE
* [VS Code](https://code.visualstudio.com/)

## Getting Started
**1. Clone the repository**

````
git clone https://github.com/ConnectedHealthServices/qa-test.git
````

**2. Install the dependencies for the test project**
`````
cd qa-evaluation
npm install
`````

**3. Install the dependencies for the local mock api server**
`````
cd mock_api_server
npm install
`````

**4. Run the local mock api server**
`````
cd ..
npm run start:api
`````

**5. Execute all the sample tests with report generation**
`````
npm run test:report
`````

**6. Visualize the report in Allure**
`````
npm run allure
`````

### Useful commands
**Execute test in debug mode (showing the request and response from the API and additional logs)**
`````
npm run test -- --debug
`````

## Project Structure
- Directory `allure-results`: containing the reports generated by allure plugin
- Directory `features`: containing test scenario definition files (`*.feature`) in Gherkin format. 
- Directory `helpers`: containing custom helpers for the project (you could add your own helpers here)
   - File `testchai_helper.ts`: helper based on chai used for assertion
- Directory `node_modules`: containing node modules used in the application
- Directory `services`: containing service wrappers (same as page object pattern, but for web services)
- Directory `step_definitions`: containing step definition corresponding to each Gherking Phrase in  `features` folder
- Directory `utils`: containing typescript function utils
- File `codecept.conf.js` is the configuration of the application itself
- File `.env` configuration file with environment variables applicable to all environments
- File `.env.local` configuration files with environment variables that should be kept local to your own PC. For instance JIRA credentials
- File `.env.dev` the configuration for the `DEV` environment. This is a sample file for configuration of your `DEV` environment. 

   If you have another environment, you could add another file with the convention `environment.{your environment name}`. 
   
   For example, if you have `UAT` environment, you could create a configuration `environment.UAT`
- File `package.json` is the configuration of the dependencies of the project.
- File `steps.d.ts` typescript definition of the gerkin steps and other helpers. This file can be generated by codeceptsjs using the command 
`````
npx codeceptjs def
`````
- File `tsconfig.json` Typescript compiler settings
- File `tsling.json` Typescript linter settings

## How to implement a test scenario

1. Create a feature file in `features` directory and put write your test scenario in Gherkin format.

For example:

Create ```example.tag2.feature``` file with the following Gherking definition
```
Feature: get programs with tag 2
  In order to get programs

  @sanity
  Scenario: test get with tag 2
    Given I have a good login
    When I get request for dialog api 2
    Then I have a status 200 
```

2. Generate the step definition template for that test scenario
```
npx codeceptjs gherkin
```
   A new step definition is generated for you in ```step_definitions/steps.js```, since the others steps exist already.

   ```
When('I get request for dialog api 2', () => {
  // From "features/example.tag.2.feature" {"line":7,"column":5}
  throw new Error('Not implemented yet');
});
```
Complete the step with the following definition:
````
When('I get request for dialog api 2', async () => {
  programs = await I.sendGetRequest('/dev/api/programs/');
});
````

Execute your tests again:
````
npm run test:report
````

## Switching Between Environment

If you would like to execute your test with another environment in your configuration. For instance for executing your test in `DEV` environment in Linux or Mac OSX:
```
SET NODE_ENV=dev npm run test:report
```

Alternatively on Windows:
```
SET NODE_ENV=dev 
npm run test:report
```

### Defining custom environments
In ordery to define a key in the `package.json` for a specific environment use the cross-env command as follows:
```
"test:local": "cross-env NODE_ENV=local codeceptjs run"
```

In this case the test are executed in the local enviroment:
```
npm run test:local
```

## Reference:
[Codeceptjs](https://codecept.io/reference)